# Common Components & Contacts System Architecture

## 1. System Overview

```mermaid
graph TD
    A[Common Components] --> B[Core Components]
    A --> C[Contact System]
    A --> D[Integration Points]
    
    B --> B1[UI Components]
    B --> B2[Form Elements]
    B --> B3[Navigation]
    
    C --> C1[Contact Management]
    C --> C2[Contact Selection]
    C --> C3[Contact Details]
    
    D --> D1[Appointments]
    D --> D2[Health Record]
    D --> D3[User Profile]
```

## 2. Common Components Structure

### 2.1 UI Components
```mermaid
graph TD
    A[Common UI Components] --> B[Headers]
    A --> C[Buttons]
    A --> D[Input Fields]
    A --> E[Bottom Sheets]
    
    B --> B1[Page Header]
    B --> B2[Bottom Sheet Header]
    B --> B3[H2 Header]
    
    C --> C1[Button Red]
    C --> C2[Button Confirm]
    C --> C3[Back Icon Button]
    
    D --> D1[Input Field Text]
    D --> D2[Input Field Mail]
    D --> D3[Input Field Password]
    
    E --> E1[Content Sheet]
    E --> E2[Appointment Sheet]
    E --> E3[Contact Sheet]
```

## 3. Contact System Flow

```mermaid
sequenceDiagram
    participant User
    participant App
    participant Firebase
    participant Components
    
    User->>App: Access Contact List
    App->>Firebase: Fetch Contacts
    Firebase-->>App: Contact Data
    App->>Components: Render Contact List
    
    loop Contact Management
        User->>Components: Select Contact
        Components->>App: Show Details
        App->>Firebase: Update Contact
        Firebase-->>App: Confirmation
    end
```

## 4. Firebase Schema

### 4.1 Contact Collections
```mermaid
erDiagram
    CONTACTS {
        string contactId
        string userId
        string name
        string type
        string specialty
        string phone
        string email
        string address
        boolean isFavorite
        json metadata
    }
    
    USER_CONTACTS {
        string userContactId
        string userId
        string contactId
        string relationship
        boolean isPrimary
        json metadata
    }
    
    APPOINTMENTS {
        string appointmentId
        string userId
        string contactId
        string type
        string status
        timestamp scheduledDate
        string reason
        string location
        string notes
        boolean isRecurring
        number frequency
        string frequencyUnit
        array attachments
        json metadata
    }
    
    SPECIALIZATION {
        string specializationId
        string name
        string description
        string category
        json metadata
    }
    
    FEEDS {
        string feedId
        string userId
        string type
        string content
        timestamp createdAt
        string status
        json metadata
    }
    
    USER_PROFILES {
        string profileId
        string userId
        string name
        string email
        string phone
        string role
        boolean isActive
        json preferences
        json metadata
    }
    
    HEALTH_INSURANCES {
        string insuranceId
        string userId
        string provider
        string policyNumber
        string type
        string status
        json coverage
        json metadata
    }
    
    USER_QUESTIONS {
        string questionId
        string userId
        string type
        string question
        string answer
        timestamp createdAt
        string status
        json metadata
    }
    
    CONTACTS ||--o{ USER_CONTACTS : belongs_to
    CONTACTS ||--o{ APPOINTMENTS : has
    CONTACTS ||--o{ SPECIALIZATION : has
    CONTACTS ||--o{ FEEDS : generates
    CONTACTS ||--o{ USER_PROFILES : relates
    CONTACTS ||--o{ HEALTH_INSURANCES : manages
    CONTACTS ||--o{ USER_QUESTIONS : generates
```

## 5. Component Integration

### 5.1 Common Components Usage
```mermaid
graph TD
    A[Common Components] --> B[Usage in Pages]
    
    B --> B1[Appointment Pages]
    B --> B2[Contact Pages]
    B --> B3[Profile Pages]
    B --> B4[Health Record Pages]
    
    B1 --> B1a[Appointment Sheet]
    B1 --> B1b[Button Confirm]
    B1 --> B1c[Input Fields]
    
    B2 --> B2a[Contact List]
    B2 --> B2b[Contact Details]
    B2 --> B2c[Contact Form]
    
    B3 --> B3a[Profile Header]
    B3 --> B3b[Profile Form]
    B3 --> B3c[Settings Sheet]
    
    B4 --> B4a[Health Record Header]
    B4 --> B4b[Record Form]
    B4 --> B4c[Document Sheet]
```

## 6. Component Features

### 6.1 Header Components
- **Page Header**
  - Title display
  - Back navigation
  - Action buttons
  - Responsive design

- **Bottom Sheet Header**
  - Title and subtitle
  - Close button
  - Custom actions
  - Consistent styling

### 6.2 Button Components
- **Button Red**
  - Primary action button
  - Error state handling
  - Loading state
  - Disabled state

- **Button Confirm**
  - Success action button
  - Confirmation dialogs
  - Loading state
  - Disabled state

### 6.3 Input Field Components
- **Input Field Text**
  - Text validation
  - Error messages
  - Placeholder text
  - Custom styling

- **Input Field Mail**
  - Email validation
  - Error messages
  - Placeholder text
  - Custom styling

## 7. Dynamic Configurations

### 7.1 Component Settings
```mermaid
graph TD
    A[Component Config] --> B[Display Settings]
    A --> C[Validation Settings]
    A --> D[Style Settings]
    
    B --> B1[Visibility]
    B --> B2[Responsiveness]
    
    C --> C1[Validation Rules]
    C --> C2[Error Messages]
    
    D --> D1[Theme]
    D --> D2[Custom Styles]
```

## 8. State Management

```mermaid
graph TD
    A[Component State] --> B[Form State]
    A --> C[UI State]
    A --> D[Data State]
    
    B --> B1[Validation State]
    B --> B2[Submission State]
    
    C --> C1[Loading State]
    C --> C2[Error State]
    
    D --> D1[Data Loading]
    D --> D2[Data Update]
```

## 9. Feature Matrix

| Component | Usage | Features | State Management |
|-----------|-------|----------|------------------|
| Page Header | All Pages | Title, Navigation, Actions | UI State |
| Button Red | Action Pages | Primary Actions, States | Form State |
| Input Field | Forms | Validation, Error Handling | Form State |
| Bottom Sheet | Modals | Content Display, Actions | UI State |

## 10. Integration Points

```mermaid
graph TD
    A[Common Components] --> B[Appointment System]
    A --> C[Contact System]
    A --> D[Profile System]
    
    B --> B1[Appointment Forms]
    B --> B2[Appointment Lists]
    
    C --> C1[Contact Forms]
    C --> C2[Contact Lists]
    
    D --> D1[Profile Forms]
    D --> D2[Settings Forms]
```

## 11. Error Handling

```mermaid
graph TD
    A[Error Types] --> B[Form Errors]
    A --> C[Validation Errors]
    A --> D[Integration Errors]
    
    B --> B1[Input Validation]
    B --> B2[Submission Errors]
    
    C --> C1[Field Validation]
    C --> C2[Format Errors]
    
    D --> D1[API Errors]
    D --> D2[Data Sync Errors]
```

## 12. Security Implementation

```mermaid
graph TD
    A[Security] --> B[Data Access]
    A --> C[User Permissions]
    A --> D[Component Security]
    
    B --> B1[Data Privacy]
    B --> B2[Access Control]
    
    C --> C1[Role Access]
    C --> C2[Action Permissions]
    
    D --> D1[Component Access]
    D --> D2[Feature Flags]
```

This architecture document provides a comprehensive overview of the Common components and Contact system. Each section can be expanded with more detailed implementation specifics as needed.
